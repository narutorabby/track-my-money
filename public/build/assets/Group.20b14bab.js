import{d as V,c as v,o as _,a as n,_ as Y,u as A,r as p,e,w as t,g as H,h as j,n as q,j as a,F as E,B,m as I,t as m,k as g,p as O,l as J}from"./app.aa08bbda.js";import{h as K}from"./moment.9709ab41.js";import{P as Q,E as W}from"./Plus.8cdbd9e7.js";import{U as X}from"./Users.fce65b5f.js";import{C as Z}from"./Check.f0fce212.js";const x={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ee=n("path",{d:"M48 48a48 48 0 1 0 48 48a48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48a48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48a48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z",fill:"currentColor"},null,-1),te=[ee],oe=V({name:"ListUl",render:function(s,k){return _(),v("svg",x,te)}});const ne={components:{Plus:Q,Users:X,EditRegular:W,ListUl:oe,Check:Z},setup:()=>{H();const o=j();q();const s=A(),k=p(!0),C=p(!1),y=p([]),f=p({id:0,name:""}),c=p(!1),r=p(!1),d=p(null),R=p({name:{required:!0,message:"Please enter name",trigger:["input","blur"]}}),b=()=>{k.value=!0,axios.get("/api/group/list").then(u=>{u.data.response=="success"?y.value=u.data.data:s.error("Error fetching list. Please reload!"),k.value=!1})};b();const D=()=>{r.value=!0},S=u=>{u.preventDefault(),d.value.validate(h=>{if(h)console.log(h);else{C.value=!0;let i="",w={};c.value?(w={...f.value},i="/api/group/update/"+f.value.id):(w={...f.value},i="/api/group/create"),axios.post(i,w).then(M=>{M.data.response=="success"?(s.success(M.data.message),b(),$()):s.error(M.data.message),C.value=!1}).catch(()=>{C.value=!1,s.error(`Could not ${c.value?"edit":"create"} group!`)})}})},$=()=>{r.value=!1,c.value=!1,f.value={id:0,name:""}};return{pageLoading:k,formSubmitLoading:C,groups:y,group:f,editFlag:c,showModalRef:r,formRef:d,rules:R,getGroups:b,openModal:D,submitForm:S,closeModal:$,editGroup:(u,h)=>{h=="edit"&&(c.value=!0);let i=y.value[u];f.value={id:i.id,name:i.name},r.value=!0},groupMembers:u=>{o.push({name:"GroupMembers",params:{slug:u}})},groupRecords:u=>{o.push({name:"GroupRecords",params:{slug:u}})},formatDate:u=>K(u).format("DD-MM-YYYY")}}},ae=o=>(O("data-v-cb48f0ca"),o=o(),J(),o),le={id:"group"},se=g(" Create New "),ue=ae(()=>n("thead",null,[n("tr",null,[n("th",null,"#"),n("th",null,"Name"),n("th",null,"Admin"),n("th",null,"Total Members"),n("th",null,"Total Records"),n("th",null,"Created At"),n("th",null,"Last Edited At"),n("th")])],-1)),re={style:{"text-align":"end"}},de=g(" Edit "),ce=g(" Members "),ie=g(" Records "),pe=g(" Create New "),me=g("Cancel");function _e(o,s,k,C,y,f){const c=a("plus"),r=a("n-icon"),d=a("n-button"),R=a("n-skeleton"),b=a("edit-regular"),D=a("users"),S=a("list-ul"),$=a("n-button-group"),F=a("n-table"),N=a("n-empty"),G=a("n-space"),z=a("n-card"),u=a("n-input"),h=a("n-form-item"),i=a("n-gi"),w=a("n-grid"),M=a("check"),P=a("n-form"),T=a("n-modal");return _(),v("section",le,[e(z,{title:"GROUPS"},{"header-extra":t(()=>[e(d,{onClick:s[0]||(s[0]=l=>o.openModal())},{icon:t(()=>[e(r,null,{default:t(()=>[e(c)]),_:1})]),default:t(()=>[se]),_:1})]),default:t(()=>[e(G,{class:"data-container",vertical:""},{default:t(()=>[o.pageLoading?(_(),v(E,{key:0},[e(R,{height:"50px"}),(_(),v(E,null,B(10,l=>e(R,{key:l,height:"50px"})),64))],64)):o.groups&&o.groups.length>0?(_(),I(F,{key:1,striped:""},{default:t(()=>[ue,n("tbody",null,[(_(!0),v(E,null,B(o.groups,(l,L)=>(_(),v("tr",{key:L},[n("td",null,m(L+1),1),n("td",null,m(l.name),1),n("td",null,m(l.admin.name),1),n("td",null,m(l.members_count),1),n("td",null,m(l.records_count),1),n("td",null,m(o.formatDate(l.created_at)),1),n("td",null,m(o.formatDate(l.updated_at)),1),n("td",re,[e($,null,{default:t(()=>[e(d,{round:"",onClick:U=>o.editGroup(L,"edit")},{icon:t(()=>[e(r,null,{default:t(()=>[e(b)]),_:1})]),default:t(()=>[de]),_:2},1032,["onClick"]),e(d,{round:"",onClick:U=>o.groupMembers(l.slug)},{icon:t(()=>[e(r,null,{default:t(()=>[e(D)]),_:1})]),default:t(()=>[ce]),_:2},1032,["onClick"]),e(d,{round:"",onClick:U=>o.groupRecords(l.slug)},{icon:t(()=>[e(r,null,{default:t(()=>[e(S)]),_:1})]),default:t(()=>[ie]),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])]),_:1})):(_(),I(N,{key:2,class:"empty",size:"huge",description:"No group found"},{extra:t(()=>[e(d,{onClick:s[1]||(s[1]=l=>o.openModal())},{icon:t(()=>[e(r,null,{default:t(()=>[e(c)]),_:1})]),default:t(()=>[pe]),_:1})]),_:1}))]),_:1})]),_:1}),e(T,{show:o.showModalRef,"onUpdate:show":s[3]||(s[3]=l=>o.showModalRef=l),"mask-closable":!1,"auto-focus":!1},{default:t(()=>[e(z,{style:{width:"600px"},name:o.editFlag?"Edit group":"Create group",size:"huge",role:"dialog","aria-modal":"true"},{default:t(()=>[e(G,{vertical:""},{default:t(()=>[e(P,{ref:"formRef",model:o.group,rules:o.rules},{default:t(()=>[e(w,{cols:"1"},{default:t(()=>[e(i,null,{default:t(()=>[e(h,{label:"Title",path:"name"},{default:t(()=>[e(u,{value:o.group.name,"onUpdate:value":s[2]||(s[2]=l=>o.group.name=l),placeholder:"Input Title",maxlength:"60","show-count":""},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(G,{justify:"end"},{default:t(()=>[e(d,{onClick:o.closeModal},{default:t(()=>[me]),_:1},8,["onClick"]),e(d,{type:"primary",onClick:o.submitForm,loading:o.formSubmitLoading},{icon:t(()=>[e(r,null,{default:t(()=>[e(M)]),_:1})]),default:t(()=>[g(" "+m(o.editFlag?"Save":"Create"),1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["name"])]),_:1},8,["show"])])}const Ce=Y(ne,[["render",_e],["__scopeId","data-v-cb48f0ca"]]);export{Ce as default};
